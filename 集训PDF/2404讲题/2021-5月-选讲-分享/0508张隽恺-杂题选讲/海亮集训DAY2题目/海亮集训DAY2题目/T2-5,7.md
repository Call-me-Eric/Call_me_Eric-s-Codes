## T2

<p><strong>温馨提示：本题不是作业题</strong></p>
<h3>题目描述</h3>
<p><code>CYJian</code> 只会造水题。</p>
<p>但是因为这是一道集训队自选题，所以 <code>CYJian</code> 想造一道不那么水的简单题。</p>
<p>首先，<code>CYJian</code> 给出了一棵 $n$ 个点的有根树。</p>
<p>然后，<code>CYJian</code> 糊了一个函数 $f(x)$ 表示 $x$ 的子树内深度最深的点到它所经过的边数。</p>
<p>最后，<code>CYJian</code> 拍脑袋想出了一个操作，需要你来执行：对树进行换根，然后求一条链上所有点的 $f(x)$ 的异或和。</p>
<h3>输入格式</h3>
<p>第一行两个整数 $n,m$ 分别表示树的点数和操作数。</p>
<p>接下来 $n-1$ 行，每行两个正整数 $u,v$ 表示树上的一条边连接了两个点 $u,v$。</p>
<p>接下来 $m$ 行，每行三个整数 $x,u,v$ 描述了一个操作：将当前的根调整为 $x$，然后求树上 $u$ 和 $v$ 之间最短路径上的点的 $f(x)$ 的异或和。</p>
<h3>输出格式</h3>
<p>$m$ 行，每行输出一个整数表示询问的链上所有点的 $f(x)$ 的异或和。</p>
<h3>输入输出样例</h3>
<h4>样例输入一</h4>
<pre><code class="sh_plain">8 5
1 2
6 2
2 4
4 5
7 3
3 5
5 8
3 7 4
3 4 2
4 3 6
6 5 6
7 6 7</code></pre>
<h4>样例输出一</h4>
<pre><code class="sh_plain">5
3
1
0
1</code></pre>
<h4>样例输入二</h4>
<pre><code class="sh_plain">10 10
3 6
6 1
9 5
5 7
7 1
1 2
2 4
4 8
8 10
10 2 2
3 7 2
5 8 8
2 1 9
2 2 3
6 8 1
10 7 2
3 10 8
8 7 2
2 5 1</code></pre>
<h4>样例输出二</h4>
<pre><code class="sh_plain">4
5
1
0
6
4
5
1
5
0</code></pre>
<h3>数据范围与约定</h3>
<p>子任务还没造</p>
<p>本题采用捆绑测试。</p>
<p>对于所有数据：$1 \leq n, m \leq 10^6$，$1 \leq x, u, v \leq n$。</p>
<p>本题共 $5$ 个子任务，各子任务的分值和限制如下：</p>
<p>$\rm Subtask\ 1\ (13 pts)$：$1 \leq n, m \leq 2 \times 10^3$。</p>
<p>$\rm Subtask\ 2\ (19 pts)$：保证所有的 $x$ 相等。</p>
<p>$\rm Subtask\ 3\ (21 pts)$：保证每次操作 $u=v$。</p>
<p>$\rm Subtask\ 4\ (22 pts)$：保证树用“对于 $i \in [2,n]$ 号点，随机选择 $[1, i-1]$ 中的某个点作为其父亲”的方式随机生成。</p>
<p>$\rm Subtask\ 5\ (25 pts)$：无特殊限制。</p>
下面是神仙lsj写的题面。

~~建议时限改回2s干掉数据结构做法~~








# 题目描述

给一棵 $n$ 个点的有根树，定义 $f(x)$ 表示 $x$ 的子树内的点到它的最大距离。

$q$ 次询问，每次给出 $x,l,r$，表示将 $x$ 设为根，然后询问 $l$ 到 $r$ 的链上所有点的 $f(x)$ 的异或和。

# 输入格式

第一行两个正整数 $n, q$。

接下来$n - 1$行，每行两个正整数 $u, v$ 表示树的所有边。

接下来$q$行，每行三个正整数 $x, l, r$，含义见题目描述。

## 输出格式

对于每组询问输出一行一个整数表示这个询问的答案。

## 数据范围

对于 $100\\%$ 的数据，保证 $n\leq 10^6, q\leq 10^6$。

需要使用读入优化。



## T3

#### 题目描述

有 $n$ 个只包含小写字符的字符串 $s_1,s_2,...,s_n$，你可以把它们按任意顺序拼接起来。

定义一个字符串是好的，当且仅当它有偶数种本质不同的子序列（计算空串）。

求出 $n!$ 种拼接方式中满足得到的字符串是好的的方案数。

#### 输入格式

输入第一行包含一个正整数 $n$ ，表示字符串数量。

接下来 $n$ 行，第 $i$ 行一个字符串 $s_i$，表示所有字符串。

#### 输出格式

输出一行一个整数，表示答案

#### 数据范围

$n\leq 20,|s_i|\leq 10^4$





## T4

<p>小吨有一个$n$个点的完全图。这个图里的每条边都有一个属于$[1,3000]$的颜色。</p>
<p>这个完全图有一个特殊的性质：<strong>对于这个图里的每一个简单环，都存在两条相邻的边，他们的颜色相同。</strong></p>
<p>对于一个关于点的集合$S$，定义$f(S)$为最大的$S$的子集$S'$的大小，使得$S'$中的任意两点之间的连边颜色都相同。</p>
<p>现在，小吨想要知道$\sum_{S \subset \{1,2,\cdots,n\}}\ \ \ f(S)$。</p>
<p>请输出答案对$10^9+7$取模的值。</p>
<h3>输入格式</h3>
<p>第一行两个整数$n$。</p>
<p>接下来$n$行，每行$n$个整数$A_{i,j}$。</p>
<p>$A_{i,j}$表示第$i$个点到第$j$个点的边的颜色。$A_{i,j}=A_{j,i}$。</p>
<p>特别地，$A_{i,i}=0$，表示没有边。</p>
<h3>输出格式</h3>
<p>输出答案对$10^9+7$取模的值。</p>
<h3>样例1</h3>
<h4>input</h4>
<pre><code>5
0 1 1 1 1
1 0 1 1 1
1 1 0 1 1
1 1 1 0 1
1 1 1 1 0</code></pre>
<h4>output</h4>
<pre><code>80</code></pre>
<h3>限制与约定</h3>
<p>对于$100\%$的数据，$n\le 3000$。</p>
您需要输入优化。



## T5

<p><strong>温馨提示</strong>：本题不是作业题。</p>
<hr /><h4>题目描述</h4>
<p>对于两个字符串 $S$ 和 $T$，定义 $S+T$ 为 $S$ 和 $T$ 按顺序连接所得的串，如 $ab+ba=abba$。</p>
<p>给定 $n$ 个字符串 $s_1,s_2,...,s_n$ ，令 $T = t_1+t_2+...+t_n$ 满足对于任意 $1 \leq i \leq n$，都有 $t_i$ 是 $s_i$ 的子串（$t_i$ 可以为空串）。令 $X$ 为本质不同的非空的 $T$ 的个数，输出 $X$ 对 $998244353$ 取模的值。</p>
<h4>输入格式</h4>
<p>注：此题的字符集可能很大。</p>
<p>第一行两个正整数 $n$ 和 $m$ ，表示字符串的个数和字符集的大小。</p>
<p>接下来 $n$ 行，第 $i$ 行先是一个数 $|s_i|$，接下来 $|s_i|$ 个数，第 $j$ 个数 $s_{i,j}$ 表示字符串 $s_i$ 的第 $j$ 个字符。</p>
<h4>输出格式</h4>
<p>一行一个整数，描述 $X$ 对 $998244353$ 取模的值。</p>
<h4>样例</h4>
<h5>input</h5>
<pre><code>3 3
3 1 2 3
3 2 1 2
3 1 1 3</code></pre>
<h5>output</h5>
<pre><code>152</code></pre>
<h5>限制与约定</h5>
<p>记 $S = \sum_{i=1}^n |s_i|$ 。</p>
<p>对于 $20\%$ 的数据，$n = 2$；</p>
<p>对于另外 $20\%$ 的数据，$n = 3$；</p>
<p>对于另外 $20\%$ 的数据，$m \leq 10$；</p>
<p>对于 $100\%$ 的数据，$1 \leq n \leq 100000,1\leq m,S \leq 300000, 1 \leq |s_i|, 1 \leq s_{i,j} \leq m$  。</p>



## T7

可能引起误解的部分已删除

### 题目描述

这是一道自选题。

小P是一位会唱歌的女孩子。

NOI2020就要来了，小P决定给参赛选手写一首歌，这首歌一共有$n$个音符，$n$可以是小于$N$的任意正整数，第$i$个音符的音高为$h_i$。小P的音域是$m$，她只能唱出$1\sim m$中的正整数音高，因此$1\le h_i\le m$。

在写歌之前，小P需要确定下这首歌的结构，她发现OIer喜欢升调，即相邻两个音符$h_i,h_{i+1}$满足$h_i\lt h_{i+1}$，若整首歌中恰有$k$处升调，小P就认为它是优美的。

在确定了结构之后，她就可以开始写歌了。不过她还是想知道，有多少满足她所给的限制的歌曲？

她听说你还有1个月就要去NOI了，于是希望你帮她计算一下这个值。

答案可能很大，输出对$998244353$取模的结果即可。

输入顺序为$N,m,k$

### Sample:
```
{2,2,1} => 1
{3,3,1} => 19
{10,10,5} => 716237036
{10,9,5} => 902228482
{9,10,5} => 142721965
{50000,200,49700} => 92374266
{500000,1000,499000} => 339928622
```
### Subtask:

对于所有数据，$2\le N,m,d\lt 2^{19}-10,k\lt N,(N-k+1)m\lt 2^{20}-10$

$1'$：$N,m,k\le 100$

$4'$：$k\le 1$

$4'$：$k\ge N-2$

$4'$：$k\le 10$

$4'$：$k\ge N-11$

$12'$：$(N-k+1)m\lt 2^{17}-10$

$33'$：$(N-k+1)m\lt 2^{19}-10$

$38'$：无特殊性质

1s/1024MB