## 「冲刺Noip2023模拟赛Day27」进步科学

时间限制：500 ms
空间限制：128 MiB
题目类型：传统
输入文件：decoration.in
输出文件：decoration.out

### 题目描述

林先森家的花园里种着一棵 $n$ 个点的树，其中 $1$ 号点为根，对于 $1 < i ≤ n$，$i$ 号点的父亲节点为 $f_i$ 号点。

这天，林先森想将这棵树装饰一下，便在每一个节点上挂了一串彩灯，并按照树的结构将所有节点的彩灯连了起来。这样一来，奇妙的现象出现了：若林先森拨动 $i$ 号点的开关，$i$ 号点的彩灯状态会发生改变，并且 $i$ 号节点会在一秒后将这个拨动效果传递给其父亲节点，即在接下来的第 $j$ 秒钟，$i$ 号点的距离为 $j$ 的祖先节点的彩灯状态会发生改变。（开 → 关/关 → 开）。

特别地，如果有多个拨动效果（无论是来自子节点或者林先森的）同时发生在一个节点上，这些效果会两两抵消，若可以正好全部抵消，则该节点的彩灯不会改变状态，也不会继续传递拨动效果。

开始时，所有节点的彩灯都是关闭状态。林先森告诉了你他期望看到的树的样子，并且他每秒钟可以拨动至多一个节点的开关。他希望知道，至少需要几秒钟才能看到他期望看到的树。（不需要是稳定的状态）

### 输入格式

第一行一个正整数 $n$。

接下来一行 $n − 1$ 个正整数，第 $i$ 个数为 $f_{i+1}$。

接下来一行 $n$ 个数，若第 $i$ 个数为 $0$ 则表示林先森希望 $i$ 号点的彩灯是关闭状态，若第 $i$个数为 $1$ 则表示林先森希望 $i$ 号点的彩灯是开启状态。

### 输出格式

输出一行一个整数，表示林先森最少需要几秒才能看到他期望看到的树。

### 样例

#### 样例输入1

```plain
4
1 2 3
0 1 1 0
```

#### 样例输出1

```plain
2
```

#### 样例输入2

```plain
7
1 1 2 2 3 3
0 1 1 1 0 0 1
```

#### 样例输出2

```plain
3
```

### 数据范围与提示

对于 $30\%$ 的数据，$n ≤ 8$。

对于另 $30\%$ 的数据，林先森希望看到所有彩灯都被点亮。

对于 $100\%$ 的数据，$1 ≤ n ≤ 16$。

### 分类标签

(无)



## 「冲刺Noip2023模拟赛Day27」吉吉没急

时间限制：1000 ms
空间限制：256 MiB
题目类型：传统
输入文件：lunch.in
输出文件：lunch.out

### 题目描述

林先森发现很多同学突然学会了毒瘤算法，他决定调查一下这是怎么一回事。

一共有 $n$ 个人，林先森知道开始时只有 $1$ 号会毒瘤算法。林先森了解到很多人一起吃过午餐；具体地，有 $m$ 条信息，其中第 $j$ 条信息描述 $u_j$ 和 $v_j$ 在 $[Lj, Rj]$ 区间中的某一天一起吃了午餐。若此时 $u_j$ 或 $v_j$ 中的一个人会毒瘤算法，那么两个人都能学会毒瘤算法。特别地，若一个人在某天和多个人一起吃午餐，那么他在学会毒瘤算法的同时会立即教给别人（同一天的午餐均视作同时发生）。

林先森知道最后学会了毒瘤算法的同学以及没有学会毒瘤算法的同学，以及一些不确定是否学会了毒瘤算法的同学。林先森想知道大家具体在哪一天共用了午餐，或者告诉林先森这样的结果是不可能出现的。

### 输入格式

第一行两个正整数 $n, m$。

接下来 $m$ 行，每行 $4$ 个正整数 $u_j, v_j, L_j, R_j$。

接下来一行 $n$ 个数，若第 $i$ 个数为 $1$，则 $i$ 号同学最后学会了毒瘤算法；若第 $i$ 个数为 $−1$，则 $i$ 号同学最后没有学会毒瘤算法。若第 $i$ 个数为 $0$，则不知道 $i$ 号同学最后是否学会了毒瘤算法。

### 输出格式

若结果不可能出现，输出一行 `Impossible`；否则，输出一行 `JJXSM`。

### 样例

#### 样例输入1

```plain
4 3
1 2 1 2
2 3 1 2
2 4 1 2
1 0 1 -1
```

#### 样例输出1

```plain
JJXSM
```


#### 样例输入2

```plain
4 4
1 2 1 2
2 3 2 3
2 4 1 2
3 4 3 4
1 0 1 -1
```

#### 样例输出2

```plain
Impossible
```

### 数据范围与提示

本题采用子任务评分。仅当你通过一个子任务下所有测试点时，你才能获得该子任务的分数。

对于所有数据，$1 ≤ n, m ≤ 200000，1 ≤ u_j, v_j ≤ n，u_j \ne v_j，1 ≤ L_i ≤ R_i ≤ 10^9$。

1. (10 分) $n, m ≤ 12，R_i ≤ 3$。

2. (15 分) $m = n − 1$，且共用午餐的关系将所有同学连接到了一起。

3. (15 分) 不存在确定没有学会毒瘤算法的同学。

4. (20 分) $n, m ≤ 2000$。

5. (40 分) 没有特殊限制。

### 分类标签

(无)



## 「冲刺Noip2023模拟赛Day27」老杰克哒

时间限制：1000 ms
空间限制：1024 MiB
题目类型：传统
输入文件：string.in
输出文件：string.out

### 题目描述

你有一个长度为 $n$ 的 $01$ 串 $s$(下标从 $1$ 开始)，现在有 $q$ 个询问，每次取出一个子串，并将该子串从左到右读，左边是高位，所组成的二进制数计为 $P$。你需要进行若干次操作，每次操作可以将 $P$ 加上或减去 $2^k$。$k$ 可以由你任意选定，但是必须保证 $P$ 在任意时刻大于等于 $0$，希望你能求出最小的操作步数使 $P$ 变为 $0$。另外，题目可能会修改 $01$ 串的任意一位。

### 输入格式

第一行一个数 $n$。

第二行一个长度为 $n$ 的字符串 $s$。

第三行一个数 $q$ 表示询问与修改次数之和。

以下 $q$ 行，每行格式如下:

第一个数 $1 \leq type \leq 2$ 表示类型。

$type = 1$ 表示是一次询问接下来两个数 $l , r$ 表示询问的区间。

$type = 2$ 表示一次修改接下来两个数 $x，y$ 表示把 $s_x$ 改为 $y$。

### 输出格式

对于每个询问输出一个数表示最少次数。

### 样例

#### 样例输入

```plain
4
1101
1
1 1 4
```

#### 样例输出

```plain
3
```

### 数据范围与提示

对于 $20\%$ 的数据，$n, q \leq 10$。

对于 $50\%$ 的数据, $n, q \leq 5000$。

对于另外 $20\%$ 的数据, 没有 $2$ 操作。

对于 $100\%$ 的数据,$n, q \leq 300000$。

### 分类标签

(无)





## 「冲刺Noip2023模拟赛Day27」季积晓淆

时间限制：1500 ms
空间限制：1024 MiB
题目类型：传统
输入文件：walk.in
输出文件：walk.out

### 题目描述

有一棵 $n$ 个节点的树，你将从任意一个点出发开始随机游走。

具体来说，在点 $u$ 的每个单位时间内你将会有 $p_u$ 的概率留在原地，有 $1−p_u$ 的概率等概率的向相邻的点移动，直到移动到 $1$ 号点才停下。

现在询问从每个点出发直至停下，所花费的时间的 $k$ 次方的期望。

可以证明，答案可以被表示成 $q × p^{-1}$的形式，你需要输出一个非负整数 $ans$, 使得 $ans ≡ q × p^{−1}(\mod  998244353)$, 保证 $p$ 将不会是 $998244353$ 的倍数。

### 输入格式

第一行两个整数 $n$ 和 $k$, 含义如题目所示。

接下来 $n − 1$ 行，每行两个整数 $u, v$，代表一条树边。

接下来一行 $n − 1$ 个整数, 第 $i$ 个 $p^{'}_{i+1}$。$p_{i+1} =p^{'}_{i+1} × 10^{-6}$ 代表留在原地的概率。

### 输出格式

输出 $n − 1$ 行，第 $i$ 输出从 $i + 1$ 号点出发直至停下，所花费的时间的 $k$ 次方的期望。

### 样例

#### 样例输入1

```plain
3 1
1 2
2 3
0 0
```

#### 样例输出1

```plain
3
4
```


#### 样例输入2

```plain
3 1
1 2
2 3
500000 500000
```

#### 样例输出2

```plain
6
8
```

#### 样例输入3

```plain
3 2
1 2
2 3
500000 500000
```

#### 样例输出3

```plain
74
104
```

### 数据范围与提示

对于 $15\%$ 的数据，保证 $n \leq 10$, $k \leq 10$。

对于 $30\%$ 的数据，保证 $n \leq 50$, $k \leq 50$。

对于 $50\%$ 的数据，保证 $n \leq 1000$, $k \leq 100$。

对于另外 $5\%$ 的数据，保证 $k = 0$。

对于另外 $15\%$ 的数据，保证 $k = 1$。

对于另外 $10\%$ 的数据，保证 $p_i = 0$。

对于 $95\%$ 的数据，保证 $k \leq 1000$。

对于 $100\%$ 的数据，保证 $nk <= 10^6$, $1 \leq n \leq 10^5$,$0 \leq k \leq 10^5$, $0 \leq p_i < 10^6$。

### 分类标签

(无)