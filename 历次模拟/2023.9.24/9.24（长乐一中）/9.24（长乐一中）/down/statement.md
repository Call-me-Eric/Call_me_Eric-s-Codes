## 简单的题

时间限制：6000 ms
空间限制：512 MiB
题目类型：传统
输入文件：easy.in
输出文件：easy.out

### 题目描述

给你三个数 $n$, $G$, $L$，要你求从 ${1, 2, ..., n}$ 中选出一个非空子集使这个子集中所有数的最大公因数恰好为 $G$，最小公倍数恰好为 $L$ 的方案数。

HHZ 觉得这个题太傻逼了，于是他对此进行了一些加强：他会给出 $Q$ 次询问，每次询问选出的子集必须包含某个正整数 $a_i$ 的前提下，方案数会是多少。

因为答案可能很大，所以你需要输出答案对 $998244853$ 取模后的结果。

### 输入格式

数据第一行包含四个正整数 $n$, $G$, $L$, $Q$，意义见题目描述。

接下来 $Q$ 行每行一个正整数 $a_i$，表示询问选出的子集必须包含某个正整数 $a_i$ 的前提下，方案数会是多少。

### 输出格式

输出包括 $Q + 1$ 行，其中第一行一个数表示不加任何限制的情况下满足条件的方案数对 $998244853$取模后的结果，接下来 $Q$ 行每行一个数表示选出的子集中包含某个正整数 $a_i$ 且满足条件的方案数对 $998244853$ 取模后的结果。

### 样例

#### 样例输入
```plain
6 1 6 4
1
2
3
6
```

#### 样例输出
```plain
7
5
5
5
5
```

### 数据范围与提示

对于 $100\%$ 的数据，保证 $1 ≤ n, G, L ≤ 10^8, 1 ≤ Q ≤ 5000, 1 ≤ a_i ≤ n$。

测试点编号|特殊性质
-|-
$1$|$G ∤ L$
$2$-$3$|$n,G,L \leq 20$
$4$-$6$|$n,G,L \leq 250$
$7$-$11$|$Q=0$
$12$-$16$|$n,G,L \leq 2 \times 10^5$
$17$-$20$|


## 还是序列

时间限制：500 ms

空间限制：512 MiB

题目类型：传统

输入文件：safpar.in

输出文件：safpar.out

### 题目描述

你有一个长度为 $n$ 的序列 {$a_i$}，现在你需要将这个序列划分成若干段。你需要保证，对于每一段 $S$,都有 $min(S_i) ≤ |S| ≤ max(S_i)$。其中 $min(S_i)$ 是这一段 $a_i$ 的最小值,$max(S_i)$ 是这一段 $a_i$ 的最大值，$|S|$ 是这一段的长度。

你需要求出所有的划分方案数，由于答案很大，你需要对 $10^9 + 7$ 取模。

### 输入格式

一行一个正整数 $n$，表示序列 {$a_i$} 的长度。

接下来一行 $n$ 个正整数，表示序列 {$a_i$}。

### 输出格式

输出一行一个数 $ans$, 代表所有的划分方案数对 $10^9 + 7$ 取模的结果。

### 样例

#### 样例输入1
```plain
7
1 6 2 3 4 3 4
```

#### 样例输出1
```plain
6
```


#### 样例2
见附加文件

### 数据范围与提示

对于 $10\%$ 的数据,$n ≤ 20$。

对于 $30\%$ 的数据,$n ≤ 1000$。

对于另外 $10\%$ 的数据,$n ≤ 10^5, a_i ≤ 500$。

对于另外 $10\%$ 的数据，保证对于任意 $a_i$ 随机在区间 $[1, n]$ 中取值。

对于另外 $10\%$ 的数据，保证 $a_i$ 只存在两种不同的数值。

对于另外 $10\%$ 的数据，保证 $a_{2i} = n$。

对于另外 $10\%$ 的数据，保证 $n ≤ 10^5$。

对于 $100\%$ 的数据，保证 $n ≤ 5 × 10^5$。

## 辉辉咖啡

时间限制：1500 ms

空间限制：1024 MiB

题目类型：传统

输入文件：envelope.in

输出文件：envelope.out

### 题目描述

辉辉咖啡 是一个新零售咖啡连锁品牌，采用无人零售、实体店及外卖的运营方式，通过APP线上下单、扫码自取等方式售卖，引进瑞士进口咖啡机，并采用阿拉比卡咖啡豆制作，为用户提供美式咖啡、拿铁、澳瑞白等产品。
 
作为 辉辉咖啡 最亲民的代言人，HHZ为了让顾客不用到店就能喝到她亲手调配的咖啡，每天会亲自配送加浓美式给 CLYZ 喜爱咖啡的 Oier 们。

CLYZ 的门口有 $n$ 个 Oier 准备领取加浓美式，编号从 $1$ 到 $n$，由于某些原因，第 $i$ 名 Oier 点的咖啡只可以让 $[i,p_i]$之间的 Oier 代取（包括 $i$ 和 $p_i$ 且 $i \leq p_i$）。

HHZ 有 $n$ 个要求，在第 $i$ 个要求⾥，她希望第 $i$ 个 Oier 点的咖啡可能不少于 $b_i$ 杯，即如果设第 $i$ 个 Oier 代取了 $a_i$ 杯咖啡（即使在现实中不可能，但咖啡的神 HHZ 说 $a_i$ 可以是任何整数），她希望 $\sum_{j=i}^{p_i}a_j \geq b_i$，如果第 $i$ 个要求不满足，则 HHZ 会增加 $t_i$ 的怨⽓值。

存在另外 $m$ 条限制，每⼀条限制形如 $\sum_{j=x_i}^{y_i} a_j\leq c_i$，即编号在 $x_i$ 和 $y_i$ 之间的 Oier 代取的咖啡杯数不超过 $c_i$。并且聪明的 HHZ 事先保证了存在⼀个正整数 ，使得 $[x_i,y_i]$这个区间可以恰好被分成 $k$ 个形如 $[s_i,p_{s_i}](i=1,2...k)$ 的区间。

当然，这 $n+m$ 条限制可能不能同时满足。 HHZ 每天送咖啡太忙了，不屑处理这么简单的问题，所以请你告诉 HHZ，在满足后 $m$ 条限制的前提下，最小的怨气值是多少。

### 输入格式

输⼊⽂件共 $n+m+1$ ⾏，第⼀⾏为两个⽤⼀个空格分开的整数 $n$,$m$，表示两种限制的条数。

第 $2$ ⾏⾄第 $n+1$ ⾏，每⾏包含三个⽤⼀个空格分开的正整数 $p_i$,$b_i$,$t_i$。

第 $n+2$ ⾏⾄第 $n+m+1$ ⾏，每⾏包含三个⽤⼀个空格分开的正整数 $x_i$,$y_i$,$c_i$。


### 输出格式

输出 HHZ 的最⼩怨⽓值。


### 样例

#### 样例输入1
```plain
5 2
1 1 1
2 2 1
3 3 1
4 4 1
5 5 1
4 5 10
1 2 1
```

#### 样例输出1
```plain
1
```



#### 样例输入2
```plain
5 3
3 2 1
3 7 1
5 5 1
5 4 4
5 3 3
1 5 5
2 5 7
3 5 4
```

#### 样例输出2
```plain
3
```

#### 样例3,4,5,6
见附加文件

### 数据范围与提示

测试点 | $n$ | $m$ | $b_i$,$c_i$ | $t_i$ | 特殊性质
-|-|-|-|-|-
$1$-$5$|$\leq 2$|$\leq 2$|$\leq 10$|$\leq 10$|无
$6$-$10$|$\leq 10$|$\leq 10$|$\leq 10$|$=1$|无
$11$-$14$|$\leq 2000$|$\leq 2000$|$\leq 10^9$|$=1$|$i=p_i$
$15$-$20$|$\leq 10^5$|$\leq 10^5$|$\leq 10^9$|$=1$|$i=p_i$
$21$-$26$|$\leq 10^5$|$\leq 10^5$|$\leq 10^9$|$\leq 10^9$|$i=p_i$
$27$-$30$|$\leq 10^5$|$\leq 10$|$\leq 10^9$|$\leq 10^9$|无
$31$-$35$|$\leq 200$|$\leq 200$|$\leq 10^9$|$=1$|无
$36$-$41$|$\leq 10^5$|$\leq 10^5$|$\leq 10^9$|$=1$|无
$42$-$46$|$\leq 10^5$|$\leq 10^5$|$\leq 10^9$|$\leq 10^9$|无
$47$-$50$|$\leq 5 \times 10^5$|$\leq 5 \times 10^5$|$\leq 10^9$|$\leq 10^9$|无


## 疯癫兄弟

时间限制：1000 ms

空间限制：512 MiB

题目类型：传统

输入文件：crazy.in

输出文件：crazy.out

### 题目描述

疯癫兄弟的绕口令变化无穷！

疯癫兄弟有个绕口令题库，里面有 $1145141919810$ 个位置用于存放绕口令，其中有 $k$ 个位置 $X_1, X_2, \cdots, X_k$ 的绕口令被偷走了！

为了找回绕口令，疯癫兄弟可以发动技能：

- 选择一个奇质数 $x$ 与连续 $x$ 个位置

- 对于每个位置，若该位置有绕口令，疯癫兄弟会吃掉这个绕口令，否则会创作一个新的绕口令放入（即状态取反）

疯癫兄弟是一个精益求精的人，他需要使得所有位置都有绕口令，但是疯癫兄弟急着去踢乌龙球，他想求助你，最少要发动几次技能才能满足条件

### 输入格式

第一行一个正整数 $k$ ，表示一开始被偷走的绕口令的位置的数量

第二行，包含 $k$ 个数字 $X_i$ ，表示一开始被偷走的绕口令的位置

### 输出格式

输出一行一个正整数表示答案

### 样例

#### 样例输入 1
```plain
2
4 5
```

#### 样例输出 1
```plain
2
```

#### 样例输入 2
```plain
9
1 2 3 4 5 6 7 8 9
```

#### 样例输出 2
```plain
3
```

#### 样例输入 3
```plain
2
1 10000000
```

#### 样例输出 3
```plain
4
```

### 数据范围与提示

对于 $20 \%$ 的数据，保证存在一种最优方案，使得所有操作区间均在 $[1, 20]$ 内

另有 $10 \%$ 的数据，保证存在一种最优方案，使得所有操作区间互不相交

另有 $10 \%$ 的数据，保证 $k$ 为质数，且 $\forall i \geq 2, X_i = X_{i - 1} + 2$

另有 $10 \%$ 的数据，保证 $k$ 为偶数，$X_{2i} = X_{2i - 1} + 1$ ，所有 $X_{2i - 1}$ 奇偶性相同

另有 $20 \%$ 的数据，$k \leq 8$

对于 $100 \%$ 的数据，$1 \leq k \leq 10^3, 0 \leq X_i \leq 10^7$ ，保证有解
