# mexor

**1s 512MB**

给定若干个自然数 $a_{1\sim n}$。

你需要选出其中一些数，然后将你选出的数划分为若干个集合。

你需要最大化每个集合 $\tt mex$ 的异或和，输出这个值。

一个集合的 ${\tt mex}$ 是指最小的不在这个集合中的数，例如 $\{0,1,2,4,5\}$ 的 ${\tt mex}$ 是 $3$，$\{1,2,3\}$ 的 ${\tt mex}$ 是 $0$。 

## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个整数 $a_{1\sim n}$。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例  1 输入

```
5
0 0 1 2 3 
```

### 样例  1 输出

```
5
```

### 样例 2 输入

```
8
0 0 1 2 2 2 3 4
```

### 样例 2 输出

```
5
```

### 样例解释

对于样例 1，选出所有数，划分为 $\{0\}$，$\{0,1,2,3\}$ 是最优的。

对于样例 2，选出 $0,1,2,3,4$ 这些数组成一个大集合是最优的。

## 数据范围

保证 $1\le n\le 10^6$，$0\le a_i\le n$。

测试点 $1\sim3$ 满足 $n\le 6$。

测试点 $4\sim7$  满足 $n \le 1000$。

测试点 $4$ 保证 $a_i = i-1$；

测试点 $5$ 保证等于 $0$ 的数有恰好一个。

测试点 $8\sim10$ 无特殊限制。

# wbtree

**2s 512MB**

给定一棵有根树，树上的每个节点是黑色或白色的。$1$ 号点是根。

请对于每个白色的点，在子树中找一个黑色的点与其匹配，其中每个黑点只能和一个白点匹配。你需要求出所有白点与其配对的黑点的距离之和最小是多少。

树上两点的距离定义为他们之间简单路径上的边数。

数据保证有解。

## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个为 $0$ 或者 $1$ 的整数，描述了每个点的颜色。若第 $i$ 个数是 $0$，则第 $i$ 个点是白色；否则是黑色。

接下来 $n-1$ 行每行两个正整数，描述了这棵树。

## 输出格式

一行一个正整数表示答案。

## 样例

### 样例 1 输入

```
6
0 0 0 1 1 1 
1 2 
1 3
2 4
3 5
3 6
```

### 样例 1 输出

```
4
```

### 样例  2 输入

```
7
0 1 1 0 0 1 1 
1 2
1 3
3 4
4 5
5 6
6 7
```

### 样例 2 输出

```
5
```

### 样例解释

对于样例 1，$1,2,3$ 分别匹配了 $5,4,6$。
对于样例 2，$1,4,5$ 分别匹配了 $2,6,7$。

### 数据范围

保证 $1\le n\le 10^6$。

对于测试点 $1\sim 3$，$n\le 1000$；

对于测试点 $4\sim 6$，$n\le 10^5$；

对于测试点 $2\sim 7$，树是一条链。

# andgraph

**1.5s 512MB**

有一张 $n$ 个点的无向图，每个点有一个点权 $a_i$。

$i$ 与 $j$ 之间有边当且仅当 $a_i\&a_j\ne 0$，其边权为 $a_i+a_j$。 其中 $\&$ 是按位与。

$q$ 次询问两个点之间的最短路，若这两点不能互相到达，则输出 $\tt -1$ 。

**注意**:  若 $s=t$ ，请大家输出 $s$ 点权的二倍作为答案。

## 输入格式

第一行三个正整数 $n,m,q$。

接下来一行 $n$ 个数表示每个点的点权。

接下来 $q$ 行每行两个正整数 $s,t$，表示要询问 $s$ 到 $t$ 的最短路。

## 输出格式

$q$ 行，第 $i$ 行一个正整数表示第 $i$ 次询问的答案。

## 样例

### 样例 1 输入

```
5 8 4
1 5 6 7 8
1 2
1 3
1 4
1 5
```

### 样例 1 输出

```
6 
17 
8 
-1
```

### 数据范围

保证 $1\le n,m,q\le 10^6,1\le a_i\le m$。

对于测试点 $1\sim 3$，$n,m,q\le 50$；

对于测试点 $4\sim 7$，$n,m,q\le 2000$。

# splitham

**2s 512MB**

哈密顿路径问题是指：找一条经过全部 $n$ 个点恰好一次的路径。

为了解决平面直角坐标系上的哈密顿路径问题，dottle 设计了这样一个算法：

设当前有 $n$ 个点，他们的横坐标互不相同，纵坐标也互不相同。

现在给出解决点集 $S$ 的算法：

-   将 $S$ 分成左右两部分。从左右两个集合中选一个，先走完这个集合的点，再走另一个集合的点；
-   在走左边或者右边的集合的时候，将该集合分成上下两部分。从上下两个集合中选一个，先走完这个集合的点，再走另一个集合的点。
-   在走上面或者下面的集合的时候，将该集合分成左右两部分。从左右两个集合中选一个，先走完这个集合的点，再走另一个集合的点；
-   以此类推，直到点集内只有一个点时停止分割。

把点集 $X$ 分成左右两部分指将 $X$ 内的点根据横坐标排序，横坐标较小的 $\lfloor |X|/2\rfloor $ 个点被分在左边的集合，其余的点被分在右边的集合。

把点集 $X$ 分成上下两部分指将 $X$ 内的点根据纵坐标排序，纵坐标较小的 $\lfloor |X|/2\rfloor  $ 个点被分在上面的集合，其余的点被分在下面的集合。

如果你找出的路径分别是 $p_{1\sim n}$，那么它的总长度为 $\sum_{i=1}^{n-1}{\rm dis}(p_i,p_{i+1})$。其中 ${\rm dis}(a,b)$ 指编号为 $a$ 与 $b$ 的点的欧几里得距离，即 $\sqrt{(x_a-x_b)^2+(y_a-y_b)^2}$。

请你求出，在满足算法要求的前提下，你找出的路径的最小总长度是多少。输出它作为答案，四舍五入到两位小数。

## 输入格式

第一行一个正整数 $n$。

接下来 $n$ 行每行两个正整数 $x,y$，描述了一个点的坐标。

## 输出格式

一行一个两位小数作为答案。

## 样例

### 样例 1 输入

```
8
4 2
8 5
2 3
7 8
1 1
5 4
6 7
3 6
```

### 样例 1 输出

```
18.20
```

### 样例解释

最优的路径是：$4~7~2~6~1~5~3~8$。

过程如下：
1. 我们把点集分为左右两部分，$1,3,5,8$ 被分到左边，$2,4,6,7$ 被分到右边；我们决定先走右边。
2. $2,4,6,7$ 被分成了上下两部分，$2,6$ 被分到上面，$4,7$ 被分到下面；我们决定先走下面；
3. $4,7$ 被分成了左右两部分 $7$ 和 $4$，我们决定先走 $4$ 再走 $7$；
4. $2,6$ 被分成了左右两部分 $2$ 和 $6$，我们决定先走 $2$ 再走 $6$；
5. $1,3,5,8$ 被分成了上下两部分，$1,5$ 被分到上面，$3,8$ 被分到下面；我们决定先走 $1,5$。
6. 后略。

## 数据范围

保证 $1\le n\le 500$，$1\le x,y\le 2000$。

对于测试点 $1\sim 3$，保证 $n\le 6$；

对于测试点 $4\sim 7$，保证 $n\le 50$；

对于测试点 $3\sim 4$，保证每个点横纵坐标都相等。