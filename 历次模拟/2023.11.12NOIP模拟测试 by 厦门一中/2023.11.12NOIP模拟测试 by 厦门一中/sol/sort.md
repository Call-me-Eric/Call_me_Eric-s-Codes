cch 题库 $\texttt{01}$ 

比较套路的一道题吧。

首先是一个性质，对于任意一个子区间，翻转的区间互不相交。最大化不参与排序的元素个数即为答案。

考虑元素在什么区间里能不参与排序。很容易看出，左部分小于等于该元素，右部分大于等于该元素的区间就可以对答案进行 $-1$ 的贡献。

对于 Sub2 ，树状数组+二分离线求得左右区间。对于 Sub3 ，用单调栈求得左右区间。

感谢 [mcw](https://www.luogu.com.cn/user/362750) 同学吊打出题人正解，加强了数据。